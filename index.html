<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DandyFinder</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #121212;
            --panel: #1e1e1e;
            --input-bg: #2a2a2a;
            --text: #ffffff;
            --accent: #6c5ce7;
            --font-main: 'Fredoka One', cursive;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: var(--font-main);
            margin: 0;
            padding: 20px;
        }

        h1, h2, h3 { letter-spacing: 1px; margin: 10px 0; }
        h1 { color: #a29bfe; font-size: 3rem; text-align: center; text-shadow: 4px 4px 0px #000; }

        .container { max-width: 1100px; margin: 0 auto; }

        /* --- JSON EDITING VISUALS --- */


        /* --- INPUTS --- */
        input, select, textarea {
            background: var(--input-bg);
            border: 2px solid #444;
            color: white;
            padding: 12px;
            border-radius: 8px;
            font-family: sans-serif; /* Readable for typing */
            width: 100%;
            box-sizing: border-box;
            margin-bottom: 10px;
            transition: 0.2s;
        }
        input:focus, select:focus { border-color: var(--accent); outline: none; }
        label { color: #ccc; font-size: 0.9rem; font-family: sans-serif; }

        /* --- THE GRID (Toons/Trinkets) --- */
        .selection-area {
            background: var(--panel);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 8px 0px #000;
        }

        .grid-list {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
        }

        /* --- THE BUTTONS & BORDERS --- */
        .game-btn {
            width: 100px;
            height: 120px;
            position: relative;
            background: #222;
            cursor: pointer;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: transform 0.1s;
            /* Default clear border area */
            padding: 6px; 
            box-sizing: border-box;
        }
        
        .game-btn:active { transform: translateY(4px); }
        .game-btn:hover { z-index: 10; transform: scale(1.05); }
        .game-btn.selected { transform: scale(1.1); box-shadow: 0 0 0 4px white; z-index: 20; }

        .game-btn img {
            width: 100%;
            height: 80px;
            object-fit: cover;
            border-radius: 6px;
            background: #000;
        }
        
        .game-btn span {
            margin-top: 5px;
            font-size: 0.8rem;
            text-align: center;
            width: 100%;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* --- BORDER LOGIC --- */
        
        /* 1. Main (Rainbow Gradient) */
        .border-main {
            background: linear-gradient(45deg, #ff0000, #ff7300, #fffb00, #48ff00, #00ffd5, #002bff, #7a00ff, #ff00c8);
            background-size: 200% 200%;
            animation: rainbow 3s ease infinite;
        }
        @keyframes rainbow { 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }

        /* 2. Lethal (Red) */
        .border-lethal { background: #ff0000; box-shadow: 0 0 10px #ff0000; }

        /* 3. Halloween (Orange) */
        .border-halloween { background: #ff8c00; box-shadow: 0 0 5px #ff8c00; }

        /* 4. Halloween-Main (Rainbow Outer, Orange Inner) */
        .border-halloween-main {
            background: linear-gradient(180deg, purple, orange);
        }

        /* 5. Christmas (Candy Cane) */
        .border-christmas {
            background: repeating-linear-gradient(45deg, #cc0000, #cc0000 10px, #ffffff 10px, #ffffff 20px);
        }

        /* 6. Christmas-Main (Rainbow Outer, Candy Inner) */
        .border-christmas-main {
            background: linear-gradient(45deg, green, red);
        }

        /* 7. Easter (Green) */
        .border-easter { background: #32cd32; box-shadow: 0 0 5px #32cd32; }

        /* 8. Easter-Main (Green + Rainbow) */
        .border-easter-main {
            background: linear-gradient(45deg, yellow, pink, cyan);
        }

        /* 9. Normal */
        .border-normal { background: #555; }
        
        /* Inner Content Mask for all buttons to keep image clean */
        .game-btn-inner {
            background: #1e1e1e;
            width: 100%;
            height: 100%;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 4px;
            box-sizing: border-box;
        }

        /* --- FORM LAYOUT --- */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .btn-submit {
            background: var(--accent);
            color: white;
            border: none;
            width: 100%;
            padding: 15px;
            font-size: 1.5rem;
            font-family: var(--font-main);
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 6px 0 #483d8b;
            margin-top: 20px;
        }
        .btn-submit:active { box-shadow: 0 2px 0 #483d8b; transform: translateY(4px); }

        /* --- RESULT CARD --- */
        .result-card {
            background: #252525;
            border: 4px solid #444;
            border-radius: 20px;
            padding: 25px;
            margin-top: 40px;
            font-family: sans-serif;
        }
        .result-header {
            display: flex; justify-content: space-between; align-items: flex-end;
            border-bottom: 2px solid #555; padding-bottom: 15px; margin-bottom: 15px;
        }
        .result-title { font-family: var(--font-main); font-size: 2rem; color: var(--accent); }
        .stat-badge { 
            background: #333; padding: 5px 10px; border-radius: 5px; 
            font-size: 0.9rem; margin-right: 5px; display: inline-block; margin-bottom: 5px;
        }
        .stat-badge b { color: #fff; }
        .stat-badge span { color: #aaa; }

    </style>
</head>
<body>

<div class="container">
    <h1>DandyFinder</h1>

    <script id="json-toons" type="application/json">
    [
        { "name": "Boxten", "image": "Boxten_Render.webp", "type": "normal" },
        { "name": "Poppy", "image": "Poppy_Render.webp", "type": "normal" },
        { "name": "Tisha", "image": "ifart.webp", "type": "normal" },
        { "name": "Toodles", "image": "Toodles_Render.webp", "type": "normal" },
        { "name": "Teagan", "image": "Teagan_Render.webp", "type": "normal" },
        { "name": "Cosmo", "image": "Cosmo_Render.webp", "type": "normal" },
        { "name": "Finn", "image": "Finn_Render.webp", "type": "normal" },
        { "name": "Razzle & Dazzle", "image": "Razzle_&_Dazzle_Render.webp", "type": "normal" },
        { "name": "Brusha", "image": "Brusha_Render.webp", "type": "normal" },
        { "name": "Brightney", "image": "Brightney_Render.webp", "type": "normal" },
        { "name": "Blot", "image": "Blot_Render.webp", "type": "normal" },
        { "name": "Looey", "image": "Looey_Render.webp", "type": "normal" },
        { "name": "Yatta", "image": "Yatta_Render.webp", "type": "normal" },
        { "name": "Scraps", "image": "Scraps_Render.webp", "type": "normal" },
        { "name": "Goob", "image": "Goob_Render.webp", "type": "normal" },
        { "name": "Glisten", "image": "Glisten_Render.webp", "type": "normal" },
        { "name": "Gigi", "image": "Gigi_Render.webp", "type": "normal" },
        { "name": "Flutter", "image": "Flutter_Render.webp", "type": "normal" },
        { "name": "Glisten", "image": "Glisten_Render.webp", "type": "normal" },
        { "name": "Connie", "image": "Connie_Render.webp", "type": "normal" },
        { "name": "Shrimpo", "image": "Shrimpo_Render.webp", "type": "normal" },
        { "name": "Coal", "image": "Coal_Render.webp", "type": "christmas-main" },
        { "name": "Rudie", "image": "Rudie_Render.webp", "type": "christmas-main" },
        { "name": "Ginger", "image": "Ginger_Render.webp", "type": "christmas-main" },
        { "name": "Eggson", "image": "Eggson_Render.webp", "type": "easter-main" },
        { "name": "Cocoa", "image": "Cocoa_Render.webp", "type": "easter-main" },
        { "name": "Flyte", "image": "Flyte_Render.webp", "type": "easter-main" },
        { "name": "Soulvester", "image": "Soulvester_Render.webp", "type": "halloween-main" },
        { "name": "Ribecca", "image": "Ribecca_Render.webp", "type": "halloween-main" },
        { "name": "Eclipse", "image": "Eclipse_Render.webp", "type": "halloween-main" },
        { "name": "Pebble", "image": "Pebble_Render.webp", "type": "main" },
        { "name": "Vee", "image": "Vee_Render.webp", "type": "main" },
        { "name": "Astro", "image": "Astro_Render.webp", "type": "main" },
        { "name": "Shelly", "image": "Shelly_Render.webp", "type": "main" },
        { "name": "Sprout", "image": "Sprout_Render.webp", "type": "main" },
        { "name": "Bassie", "image": "Bassie_Render.webp", "type": "main" },
        { "name": "Bobette", "image": "Bobette_Render.webp", "type": "main" },
        { "name": "Gourdy", "image": "Gourdy_Render.webp", "type": "main" },
        { "name": "Dandy", "image": "Dandy_Render.webp", "type": "lethal" },
        { "name": "Dyle", "image": "Dyle_Render.webp", "type": "lethal" }
    ]
    </script>

    <script id="json-trinkets" type="application/json">
    [
        { "name": "Pink Bow", "image": "Pink_Bow.webp", "type": "normal" },
        { "name": "Dandy Plush", "image": "Dandy_Plush.webp", "type": "lethal" }
    ]
    </script>
    
    <div class="selection-area">
        <h3>1. Select Toon</h3>
        <input type="hidden" id="input-toon">
        <div id="toon-grid" class="grid-list"></div>
    </div>

    <div class="selection-area">
        <h3>2. Select Trinkets</h3>
        <div id="trinket-grid" class="grid-list"></div>
    </div>

    <div class="selection-area" style="background:transparent; padding:0; box-shadow:none;">
        <div class="form-grid">
            <div>
                <label>User</label>
                <input type="text" id="input-user" placeholder="Roblox Username">
            </div>
            <div>
                <label>Display Name</label>
                <input type="text" id="input-display" placeholder="Display Name (Opt)">
            </div>
            <div>
                <label>Floor Reached</label>
                <input type="number" id="input-floor">
            </div>
             <div>
                <label>Died To</label>
                <input type="text" id="input-died" placeholder="Twisted...">
            </div>
            <div>
                <label>Run Type</label>
                <select id="input-runtype">
                    <option>Standard</option>
                    <option>Main Hunt</option>
                    <option>Toon Hunt</option>
                    <option>Main Only</option>
                    <option>Lethal</option>
                    <option>Pro</option>
                    <option>Machine Crusher</option>
                    <option>Voice Chat</option>
                    <option>Matchmaking/Quick play</option>
                    <option>Solo</option>
                    <option>Other</option>
                </select>
            </div>
        </div>
        
        <br>
        <button type="button" onclick="toggleStats()" style="background:#444; color:white; border:none; padding:10px; cursor:pointer;">+ Toggle Advanced Stats</button>
        <div id="advanced-stats" class="form-grid" style="display:none; margin-top:10px; border-top:1px dashed #555; padding-top:10px;">
            <input type="number" id="stat-toons" placeholder="Toons Owned">
            <input type="number" id="stat-trinkets" placeholder="Trinkets Owned">
            <input type="number" id="stat-ichor" placeholder="Total Ichor">
            <input type="number" id="stat-floors" placeholder="Floors Survived">
        </div>

        <button class="btn-submit" onclick="createGoal()">CREATE GOAL CARD</button>
    </div>

    <div id="output-area"></div>
</div>

<script>
    // 1. Load JSON from HTML Script Tags
    let toons = [];
    let trinkets = [];

    try {
        toons = JSON.parse(document.getElementById('json-toons').textContent);
        trinkets = JSON.parse(document.getElementById('json-trinkets').textContent);
    } catch (e) {
        console.error("JSON Error: Check your commas and quotes!", e);
        alert("Error parsing JSON. Check console.");
    }

    let selectedToon = null;
    let selectedTrinkets = [];

    // 2. Render Functions
    function renderGrid(data, containerId, type) {
        const container = document.getElementById(containerId);
        container.innerHTML = '';

        data.forEach(item => {
            const btn = document.createElement('div');
            // Apply border class based on JSON type
            btn.className = `game-btn border-${item.type}`;
            
            // Logic change: Use local filename directly. 
            // Fallback to a placeholder URL if the name is empty.
            const imgUrl = item.image ? item.image : "https://via.placeholder.com/150/333333/ffffff?text=?";

            btn.innerHTML = `
                <div class="game-btn-inner">
                    <img src="${imgUrl}" alt="${item.name}" onerror="this.src='https://via.placeholder.com/150?text=File+Not+Found';">
                    <span>${item.name}</span>
                </div>
            `;

            btn.addEventListener('click', () => {
                if(type === 'toon') {
                    // Deselect all other toons
                    document.querySelectorAll('#toon-grid .game-btn').forEach(b => b.classList.remove('selected'));
                    btn.classList.add('selected');
                    selectedToon = item;
                } else {
                    // Toggle trinkets
                    btn.classList.toggle('selected');
                    if(btn.classList.contains('selected')) {
                        selectedTrinkets.push(item);
                    } else {
                        selectedTrinkets = selectedTrinkets.filter(t => t.name !== item.name);
                    }
                }
            });

            container.appendChild(btn);
        });
    }

    function toggleStats() {
        const stats = document.getElementById('advanced-stats');
        stats.style.display = stats.style.display === 'none' ? 'grid' : 'none';
    }

    function createGoal() {
        const user = document.getElementById('input-user').value || "Unknown";
        const floor = document.getElementById('input-floor').value || "0";
        const died = document.getElementById('input-died').value || "Survived";
        
        // Build Trinket String
        const trinketNames = selectedTrinkets.map(t => t.name).join(", ");

        const card = document.createElement('div');
        card.className = 'result-card';
        
        // Toon Image Logic
        let toonImgHtml = '';
        if(selectedToon) {
            const imgUrl = selectedToon.image ? selectedToon.image : "https://via.placeholder.com/150/333333/ffffff?text=?";
            // We reuse the button styling for the display
            toonImgHtml = `
            <div class="game-btn border-${selectedToon.type}" style="cursor:default; transform:none; width:80px; height:100px;">
                <div class="game-btn-inner">
                    <img src="${imgUrl}" onerror="this.src='https://via.placeholder.com/150?text=File+Not+Found';">
                </div>
            </div>`;
        }

        card.innerHTML = `
            <div class="result-header">
                <div>
                    <div class="result-title">FLOOR ${floor}</div>
                    <div style="color:#888;">${new Date().toLocaleDateString()}</div>
                </div>
                <div style="text-align:right;">
                    <h2 style="margin:0; color:white;">${document.getElementById('input-display').value || user}</h2>
                    <span style="color:#666">@${user}</span>
                </div>
            </div>

            <div style="display:flex; gap:20px; align-items:center;">
                ${toonImgHtml}
                <div style="flex-grow:1;">
                    <div class="stat-badge"><span>Toon:</span> <b>${selectedToon ? selectedToon.name : 'None'}</b></div>
                    <div class="stat-badge"><span>Fate:</span> <b style="color:#ff6b6b">${died}</b></div>
                    <div class="stat-badge"><span>Trinkets:</span> <b>${trinketNames || 'None'}</b></div>
                </div>
            </div>
        `;

        const output = document.getElementById('output-area');
        output.insertBefore(card, output.firstChild);
    }

    // Init
    renderGrid(toons, 'toon-grid', 'toon');
    renderGrid(trinkets, 'trinket-grid', 'trinket');

</script>
</body>
</html>
